!function(e){"use strict";e(document).ready((function(){a.init()}));var a={init:function(){var n=e(".it-form");n.length&&n.each((function(){var n=e(this);a.handleForm(n),a.initSchoolSelect(n)}))},handleForm:function(n){n.on("submit",(function(n){n.preventDefault();var t=e(this),o=t.find(".it-form-response"),i="",s={};if("donatori"===t.attr("data-type")){var l=a.escapeEmail(t.find('[name="email"]').val()),r=a.escapeYesNo(t.find('[name="monthly_support"]').val()),c=a.escapeNumber(t.find('[name="amount"]').val()),m=a.escapeHTML(t.find('[name="message"]').val());if(!l||!c||!m)return void o.empty().html("Molimo popunite sva obavezna polja.");s={type:t.attr("data-type"),email:l,monthly_support:r,amount:c,message:m},i="Donator je uspešno registrovan."}else if("delegati"===t.attr("data-type")){l=a.escapeEmail(t.find('[name="email"]').val());var p=a.escapeHTML(t.find('[name="full_name"]').val()),u=a.escapeSchoolType(t.find('[name="school_type"]').val()),f=a.escapeHTML(t.find('[name="city"]').val()),d=a.escapeHTML(t.find('[name="school_name"]').val()),v=a.escapeNumber(t.find('[name="suspended_number"]').val()),h=a.escapeNumber(t.find('[name="total_number"]').val());if(m=a.escapeHTML(t.find('[name="message"]').val()),!(l&&p&&u&&f&&d&&v&&h))return void o.empty().html("Molimo popunite sva obavezna polja.");s={type:t.attr("data-type"),email:l,full_name:p,school_type:u,city:f,school:d,suspended_number:v,total_number:h,message:m},i="Delegat je uspešno registrovan."}else if("osteceni"===t.attr("data-type")){p=a.escapeHTML(t.find('[name="full_name"]').val()),f=a.escapeHTML(t.find('[name="city"]').val()),d=a.escapeHTML(t.find('[name="school_name"]').val());var y=a.escapeHTML(t.find('[name="bank_account"]').val());if(c=a.escapeNumber(t.find('[name="amount"]').val()),!(p&&f&&d&&y&&c))return void o.empty().html("Molimo popunite sva obavezna polja.");s={type:t.attr("data-type"),full_name:p,city:f,school:d,bank_account:y,amount:c},i="Osteceni je uspešno registrovan."}e.ajax({url:"https://api.donacije.com/register",type:"POST",contentType:"application/json",data:JSON.stringify(s),success:function(e){o.empty().html(i)},error:function(e,a,n){var t=e.responseJSON?e.responseJSON.message:n;o.empty().html("Došlo je do greške: "+t)}})}))},escapeEmail:function(e){return e?(e=e.trim().toLowerCase(),/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$/.test(e)?e:""):""},escapeNumber:function(e){return e?(e=parseFloat(e),isNaN(e)||e<=0?0:e.toFixed(2)):0},escapeYesNo:function(e){return["DA","NE"].includes(e)?e:"NE"},escapeSchoolType:function(e){return["OŠ","SŠ","G"].includes(e)?e:""},escapeHTML:function(e){var a=document.createElement("div");return e?(a.innerText=e,a.textContent=e,a.innerHTML):""},initSchoolSelect:function(a){var n=a.find(".it-school-city"),t=a.find(".it-school-name");n.length&&t.length&&n.on("change",(function(){var a=e(this).val();t.val(""),t.find("optgroup").hide(),t.find('optgroup[label*="'+a+'"]').show()}))}}}(jQuery);